FROM theotw/devstack:go1.18.3  as build
LABEL stage=build
WORKDIR /build
RUN mkdir -p web
RUN mkdir -p webout
COPY ./ ./
ENV PATH=$PATH:/root/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin/
ENV GOSUMDB=off
ARG IMAGE_TAG=latest
RUN make incontainergenerate
RUN make protoc-install
RUN echo $PATH
RUN make buildlinux
RUN make buildtest
